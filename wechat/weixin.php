<?php

include_once 'weixin.class.php'; //å¼•ç”¨åˆšå®šä¹‰çš„å¾®ä¿¡æ¶ˆæ¯å¤„ç†ç±»
include_once 'functions.php';
define("TOKEN", "mmhelper");
define('DEBUG', false);

$weixin = new Weixin(TOKEN, DEBUG); //å®ä¾‹åŒ–
$weixin->getMsg();
$type = $weixin->msgtype; //æ¶ˆæ¯ç±»å‹
$username = $weixin->msg['FromUserName']; //å“ªä¸ªç”¨æˆ·ç»™ä½ å‘çš„æ¶ˆæ¯,è¿™ä¸ª$usernameæ˜¯å¾®ä¿¡åŠ å¯†ä¹‹åçš„ï¼Œä½†æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„

$help_txt = "è¯•è¯•è¾“å…¥ä¸‹é¢å…³é”®è¯è·å–ä¿¡æ¯:\r1.æŠ¥æ—¶\r2.æ¯æ—¥ä¸€å¥\r3.æŠ½ç­¾\r4.çŒœè°œ\r5.ç¬‘è¯\r6.ç³—äº‹\r7.QQå‰å‡¶(ä¾‹:1234)\r8.md5åŠ å¯†(ä¾‹:md5 admin)\r9.è®¡ç®—å™¨(ä¾‹:è®¡ç®—å™¨1+3-2ï¼‰\r10.ç©ºæ°”è´¨é‡(ä¾‹:å¦é—¨ç©ºæ°”è´¨é‡)\r11.å¤©æ°”(ä¾‹:å¦é—¨å¤©æ°”)\r12.èº«ä»½è¯(ä¾‹:445224...)\r13.ipæŸ¥è¯¢(ä¾‹:12.64.235.86)\r14.æ‰‹æœºå½’å±åœ°(ä¾‹:13838383838)\r15.æ±‰å­—è½¬æ‹¼éŸ³(ä¾‹:æ‹¼éŸ³å°è±†)\r16.æŸ¥å¿«é€’(ä¾‹:å¿«é€’1106279322505)\r17.è—å¤´è¯—(ä¾‹:è—å¤´è¯—æˆ‘ä¸ºç§‹é¦™)\r18.ç¿»è¯‘(ä¾‹:ç¿»è¯‘æˆ‘çˆ±ä½ )\r19.å¤‡æ¡ˆå·(ä¾‹:å¤‡æ¡ˆå·douqq.com)\r20.é“¶è¡Œå¡(ä¾‹:é“¶è¡Œå¡622848...)\r21.äººæ°‘å¸æ•°å­—è½¬å¤§å†™(ä¾‹:å¤§å†™1542)\r22.äººå“(ä¾‹:äººå“åˆ˜å°è™)\r23.ç£åŠ›é“¾æ¥(ä¾‹:ç£åŠ›å˜å½¢é‡‘åˆš)\r24.å‘¨å…¬è§£æ¢¦(ä¾‹:æ¢¦è§ç»“å©š)\r25.æ–°åå­—å…¸(ä¾‹:å­—å…¸è±†)\r26.æ±‰è¯­è¯å…¸(ä¾‹:è¯å…¸å°è±†)\r27.æˆè¯­è¯å…¸(ä¾‹:æˆè¯­å¤§æ™ºè‹¥æ„š)\r28.æ— æŸéŸ³ä¹(ä¾‹:æ— æŸå°è‹¹æœ)\r29.æŸ¥æ­Œè¯(ä¾‹:æ­Œè¯å°è‹¹æœ)\r30.ç–¾ç—…ç—‡çŠ¶(ä¾‹:æ„Ÿå†’ç—‡çŠ¶)\r31.ç–¾ç—…ç—…å› (ä¾‹:æ„Ÿå†’ç—…å› )\r32.ç–¾ç—…æ²»ç–—(ä¾‹:æ„Ÿå†’æ€ä¹ˆæ²»ç–—)\r33.èœè°±æŸ¥è¯¢(ä¾‹:è±†æ²™åŒ…çš„åšæ³•)\r34.ç™¾ç§‘æŸ¥è¯¢(ä¾‹:ä»€ä¹ˆæ˜¯æœºå™¨äºº)\r35.å†å²ä¸Šçš„ä»Šå¤©\r36.ç™¾å®¶å§“(ä¾‹:é»„)\r37.çŸ¥é“é—®ç­”(ä¾‹:å¼•èµ·å¤´æ™•çš„åŸå›  æˆ–è€… ä¸ºä»€ä¹ˆæˆ‘çš„ç”µè„‘å¾ˆå¡)\r38.ç”µå½±ä¸‹è½½(ä¾‹:ç”µå½±ç–¯ç‹‚åŠ¨ç‰©åŸ)\r39.çŸ­ç½‘å€è½¬æ¢(ä¾‹:çŸ­ç½‘å€http://www.baidu.com)\r40.è„‘ç­‹æ€¥è½¬å¼¯(ä¾‹:è„‘ç­‹æ€¥è½¬å¼¯)\r41.ä¸åœ¨ğŸ‘†åˆ™è‡ªåŠ¨èŠå¤©ï¼Œè°¢è°¢å…³æ³¨ï¼Œçˆ±ä½ ä¹ˆä¹ˆå“’ğŸ˜˜";

if ($type === 'text') {
    if ($weixin->msg['Content'] == 'Hello2BizUser') {
        //å¾®ä¿¡ç”¨æˆ·ç¬¬ä¸€æ¬¡å…³æ³¨ä½ çš„è´¦å·çš„æ—¶å€™ï¼Œä½ çš„å…¬ä¼—è´¦å·å°±ä¼šå—åˆ°ä¸€æ¡å†…å®¹ä¸º'Hello2BizUser'çš„æ¶ˆæ¯
        $reply = $weixin->makeText('æ¬¢è¿ä½ å…³æ³¨æˆ‘,å‘é€ â€œhâ€ è·å–å¸®åŠ©ä¿¡æ¯ï¼');

    } elseif ($weixin->msg['Content'] == 'h' || $weixin->msg['Content'] == 'H' || $weixin->msg['Content'] == 'å¸®åŠ©') {

        $reply = $weixin->makeText($help_txt);

    } elseif ($weixin->msg['Content'] == 'é»„æ³½è€¿' || $weixin->msg['Content'] == 'æ³½è€¿') {

        $reply = $weixin->makeText($weixin->msg['Content'] . 'æ˜¯å®‡å®™æ— æ•Œç¬¬ä¸€å¤§å¸…å“¥å•¦å•¦å•¦ğŸ˜');

    } else {

        $content = Curl_get("http://api.douqq.com/?key=UjZDaHVjPVZQMDNwTmt4PUFuOUlMc3lzQlFvQUFBPT0&msg=" . $weixin->msg['Content']);
        $content = ClearHtml($content);
        $content = strCut($content, 1600, '...');
        $reply = $weixin->makeText($content);
    }
} elseif ($type === 'event') {

    //å…³æ³¨å›å¤å¸®åŠ©æ–‡å­—
    if ($weixin->msg['Event'] == 'subscribe') {
        $reply = $weixin->makeText('æ¬¢è¿ä½ å…³æ³¨æˆ‘,å‘é€ â€œhâ€ è·å–å¸®åŠ©ä¿¡æ¯ï¼');
    }

} elseif ($type === 'location') {
    //ç”¨æˆ·å‘é€çš„æ˜¯ä½ç½®ä¿¡æ¯  ç¨åçš„æ–‡ç« ä¸­ä¼šå¤„ç†
} elseif ($type === 'image') {
    //ç”¨æˆ·å‘é€çš„æ˜¯å›¾ç‰‡ ç¨åçš„æ–‡ç« ä¸­ä¼šå¤„ç†
} elseif ($type === 'voice') {
    //ç”¨æˆ·å‘é€çš„æ˜¯å£°éŸ³ ç¨åçš„æ–‡ç« ä¸­ä¼šå¤„ç†
}
$weixin->reply($reply);